!function(){"use strict";var t="undefined"!=typeof window?window:global;if("function"!=typeof t.require){var e={},r={},n=function(t,e){return{}.hasOwnProperty.call(t,e)},o=function(t,e){var r,n,o=[];r=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var i=0,a=r.length;a>i;i++)n=r[i],".."===n?o.pop():"."!==n&&""!==n&&o.push(n);return o.join("/")},i=function(t){return t.split("/").slice(0,-1).join("/")},a=function(e){return function(r){var n=i(e),a=o(n,r);return t.require(a,e)}},s=function(t,e){var n={id:t,exports:{}};return r[t]=n,e(n.exports,a(t),n),n.exports},u=function(t,i){var a=o(t,".");if(null==i&&(i="/"),n(r,a))return r[a].exports;if(n(e,a))return s(a,e[a]);var u=o(a,"./index");if(n(r,u))return r[u].exports;if(n(e,u))return s(u,e[u]);throw new Error('Cannot find module "'+t+'" from "'+i+'"')},c=function(t,r){if("object"==typeof t)for(var o in t)n(t,o)&&(e[o]=t[o]);else e[t]=r},p=function(){var t=[];for(var r in e)n(e,r)&&t.push(r);return t};t.require=u,t.require.define=c,t.require.register=c,t.require.list=p,t.require.brunch=!0}}(),require.register("initialize",function(t,e){var r,n;r=e("application"),n=new r}),require.register("MapControl",function(t,e,r){var n;r.exports=n=function(){function t(){var t,r,n=this;this.markerDict={},this.map=L.map("map",{scrollWheelZoom:!1}).setView([59.9218,10.73427],10).addLayer(L.mapbox.tileLayer("evenwestvang.hp8gagn1",{detectRetina:!0})),r=d3.select(this.map.getPanes().overlayPane).append("svg"),t=r.append("g").attr("class","leaflet-zoom-hide"),d3.json("data/primaries.json",function(t){var r,o,i,a;return a=L.icon({iconUrl:"images/small_icon.png",iconRetinaUrl:"images/small_icon@2x.png",iconSize:[20,20],iconAnchor:[10,10],popupAnchor:[0,-1]}),i=e("templates/popup"),r=function(t,e){var r;return r=t.properties,r?e.bindPopup(i({properties:r})):void 0},o=function(t,e){var r;return r=L.marker(e,{icon:a}),n.markerDict[t.properties.NAVN]=r},L.geoJson(t,{pointToLayer:o,onEachFeature:r}).addTo(n.map)}),d3.json("data/school_boundaries.topo.json",function(e){var o,i,a,s,u,c;return a=function(t,e,r){var o;return o=n.map.latLngToLayerPoint(new L.LatLng(e,t)),r.stream.point(o.x,o.y)},s=function(){var e,n,a;return n=i.bounds(u),a=n[0],e=n[1],r.attr("width",e[0]-a[0]).attr("height",e[1]-a[1]).style("left",a[0]+"px").style("top",a[1]+"px"),t.attr("transform","translate("+-a[0]+","+-a[1]+")"),o.attr("d",i)},u=topojson.mesh(e,e.objects.school_boundaries),c=d3.geo.transform({point:function(t,e){return a(t,e,this)}}),i=d3.geo.path().projection(c),o=t.append("path").datum(u),n.map.on("viewreset",s),s()})}return t.prototype.focusOnSchoolName=function(t){var e;return window.location="#map",console.info(this.markerDict[t]),e=this.markerDict[t],e.openPopup(),this.map.setView(e._latlng,13)},t}()}),require.register("SearchBox",function(t,e,r){var n,o=function(t,e){return function(){return t.apply(e,arguments)}};r.exports=n=function(){function t(t){this.search=o(this.search,this),this.updateView=o(this.updateView,this);var r=this;this.controller=t,this.streetTemplate=e("templates/street_listing"),d3.csv("data/addresses.csv",function(t){return r.addresses=t,r.addressDict={},r.addresses.forEach(function(t){return t.oddStart=+t.oddStart,t.evenStart=+t.evenStart,t.oddEnd=+t.oddEnd,t.evenEnd=+t.evenEnd,t.street=r.capitaliseFirstLetter(t.street),t.school=r.capitaliseFirstLetter(t.school),t.entireStreet=1!==t.oddStart&&0!==t.oddStart||2!==t.evenStart&&0!==t.evenStart||9999!==t.oddEnd&&0!==t.oddEnd||9998!==t.evenEnd&&0!==t.evenEnd?!1:!0,9999===t.oddEnd&&(t.oddEnd="slutten"),9998===t.evenEnd&&(t.evenEnd="slutten"),null==r.addressDict[t.street]&&(r.addressDict[t.street]=[]),r.addressDict[t.street].push(t)}),$("input#streetName").keyup(r.updateView)})}return t.prototype.capitaliseFirstLetter=function(t){return t=t.toLowerCase(),t.charAt(0).toUpperCase()+t.slice(1)},t.prototype.updateView=function(){var t,e,r,n=this;return t=$("input#streetName").val(),r=this.search(t),e="<ul>",r.forEach(function(t){var r,o;return o=t.sort(function(t,e){return t.oddStart>e.oddStart}),o=o.filter(function(t){return!(0===t.oddStart)}),r=t.sort(function(t,e){return t.evenStart>e.evenStart}),r=r.filter(function(t){return!(0===t.evenStart)}),e+=n.streetTemplate({street:t[0],even:r,odd:o})}),e+="</ul>",$(".searchResults").html(e),$(".searchResults .schoolName").click(function(t){return n.controller.focusOnSchoolName(t.currentTarget.innerText)})},t.prototype.search=function(t){var e,r,n,o,i,a,s=this;if(t=t.replace(/\s/g,""),o=[],""===t)return o;for(e="",n=t.length-1,r=a=0;n>=0?n>=a:a>=n;r=n>=0?++a:--a)e+=t.charAt(r)+"+.?";return i=new RegExp(e,"i"),Object.keys(this.addressDict).every(function(t){return i.test(t)&&o.push(s.addressDict[t]),o.length>10?!1:!0}),o},t}()}),require.register("application",function(t,e,r){var n,o,i;o=e("MapControl"),i=e("SearchBox"),r.exports=n=function(){function t(){this.searchBox=new i(this),this.mapControl=new o}return t.prototype.focusOnSchoolName=function(t){return this.mapControl.focusOnSchoolName(t)},t}()});